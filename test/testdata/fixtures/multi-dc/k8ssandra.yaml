apiVersion: k8ssandra.io/v1alpha1
kind: K8ssandraCluster
metadata:
  name: test
spec:
  k8sContextsSecret: k8s-contexts
  cassandra:
    cluster: test
    datacenters:
      - metadata:
          name: dc1
        k8sContext: kind-k8ssandra-0
        serverImage: emerkle826/cass-mgmtapi:3.11.11-v0.1.28
        size: 3
        serverVersion: "3.11.10"
        storageConfig:
          cassandraDataVolumeClaimSpec:
            storageClassName: standard
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 5Gi
        config:
          cassandra-yaml:
            auto_snapshot: false
            memtable_flush_writers: 1
            commitlog_segment_size_in_mb: 2
            concurrent_compactors: 1
            compaction_throughput_mb_per_sec: 0
            sstable_preemptive_open_interval_in_mb: 0
            key_cache_size_in_mb: 0
            thrift_prepared_statements_cache_size_mb: 1
            prepared_statements_cache_size_mb: 1
            start_rpc: false
            slow_query_log_timeout_in_ms: 0
            counter_cache_size_in_mb: 0
            concurrent_reads: 2
            concurrent_writes: 2
            concurrent_counter_writes: 2
          jvm-options:
            initial_heap_size: "384m"
            max_heap_size: "384m"
        resources:
          limits:
             memory: "768Mi"
        stargate:
          size: 1
          heapSize: 256Mi
          resources:
            limits:
              memory: "512Mi"
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /checker/liveness
              port: health
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 10
      - metadata:
          name: dc2
        k8sContext: kind-k8ssandra-1
        serverImage: emerkle826/cass-mgmtapi:3.11.11-v0.1.28
        size: 3
        serverVersion: "3.11.10"
        storageConfig:
          cassandraDataVolumeClaimSpec:
            storageClassName: standard
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 5Gi
        config:
          cassandra-yaml:
            auto_snapshot: false
            memtable_flush_writers: 1
            concurrent_compactors: 1
            commitlog_segment_size_in_mb: 2
            compaction_throughput_mb_per_sec: 0
            sstable_preemptive_open_interval_in_mb: 0
            start_rpc: false
            key_cache_size_in_mb: 0
            thrift_prepared_statements_cache_size_mb: 1
            prepared_statements_cache_size_mb: 1
            slow_query_log_timeout_in_ms: 0
            counter_cache_size_in_mb: 0
            concurrent_reads: 2
            concurrent_writes: 2
            concurrent_counter_writes: 2
          jvm-options:
            initial_heap_size: "384m"
            max_heap_size: "384m"
        resources:
          limits:
            memory: "768Mi"
        stargate:
          size: 1
          heapSize: 256Mi
          resources:
            limits:
              memory: "512Mi"
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /checker/liveness
              port: health
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 10